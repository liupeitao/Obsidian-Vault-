# Nginxæ•™ç¨‹

# Nginx

# [1.]()****â€‹**è¯¾ç¨‹ç›®æ ‡**

ã€€ã€€[ç›®æ ‡]()1ï¼šæŒæ¡Nginxçš„å®‰è£…

ã€€ã€€ç›®æ ‡2ï¼šæŒæ¡Nginxçš„é™æ€ç½‘ç«™éƒ¨ç½²

ã€€ã€€ç›®æ ‡3ï¼šç†è§£Nginxçš„åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡ï¼Œèƒ½å¤Ÿé…ç½®åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡

# è¯¾ç¨‹å¤§çº²

* [1.è¯¾ç¨‹ç›®æ ‡](siyuan://blocks/20221213094955-hnbozog)
* [è¯¾ç¨‹å¤§çº²](siyuan://blocks/20221213173658-tq4ojve)
* [2.Nginxçš„å®‰è£…ä¸å¯åŠ¨](siyuan://blocks/20221213094955-0kqfd3p)

  * [2.1ä»€ä¹ˆæ˜¯Nginx](siyuan://blocks/20221213094955-9xo1i42)

    * [2.1.1Â Nginx åº”ç”¨åœºæ™¯ï¼š](siyuan://blocks/20221213094955-yfsabqm)
  * [2.2 Nginxåœ¨Linuxä¸‹çš„å®‰è£…](siyuan://blocks/20221213094955-zzghv8v)

    * [2.2.1ç¯å¢ƒå‡†å¤‡](siyuan://blocks/20221213094955-695a7a0)
    * [2.2.2 Nginxä¸‹è½½](siyuan://blocks/20221213094955-q933804)
    * [2.2.3 Nginxå®‰è£…](siyuan://blocks/20221213094955-1p9clyy)

      * [Â çŸ¥è¯†ç‚¹å°è´´å£«](siyuan://blocks/20221213171028-32wrdxq)
  * [2.3 Nginxå¯åŠ¨å…³é—­ä¸è®¿é—®](siyuan://blocks/20221213094955-cp43ybn)
* [3.Nginxé™æ€ç½‘ç«™éƒ¨ç½²](siyuan://blocks/20221213094955-qgaxfy3)

  * [3.1 é™æ€ç½‘ç«™çš„éƒ¨ç½²](siyuan://blocks/20221213094955-fgvr4rs)
  * [3.2 é…ç½®è™šæ‹Ÿä¸»æœº](siyuan://blocks/20221213094955-q35idmb)

    * [3.2.1 ç«¯å£ç»‘å®š](siyuan://blocks/20221213094955-gnqwwfd)
    * [3.2.2 åŸŸåç»‘å®š](siyuan://blocks/20221213094955-0p7n2m8)
* [4.Nginxåå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡](siyuan://blocks/20221213094955-cqjngs4)

  * [4.1 åå‘ä»£ç†](siyuan://blocks/20221213094955-6mon8x1)

    * [4.1.1 ä»€ä¹ˆæ˜¯åå‘ä»£ç†](siyuan://blocks/20221213094955-rioe0es)
    * [4.1.2 é…ç½®åå‘ä»£ç†-å‡†å¤‡å·¥ä½œ](siyuan://blocks/20221213094955-q1uexi3)
    * [4.1.3 é…ç½®åå‘ä»£ç†](siyuan://blocks/20221213094955-idcpskx)
  * [4.2 è´Ÿè½½å‡è¡¡](siyuan://blocks/20221213094955-p28fcdw)

    * [4.2.1 ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡](siyuan://blocks/20221213094955-40e6rfr)
    * [4.2.2 é…ç½®è´Ÿè½½å‡è¡¡-å‡†å¤‡å·¥ä½œ](siyuan://blocks/20221213094955-mm4incq)
    * [4.2.3 é…ç½®è´Ÿè½½å‡è¡¡](siyuan://blocks/20221213094955-gqxztf2)

# **2.Nginxçš„å®‰è£…ä¸å¯åŠ¨**

## **2.1ä»€ä¹ˆæ˜¯Nginx**

ã€€ã€€Nginx æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½çš„ http æœåŠ¡å™¨/åå‘ä»£ç†æœåŠ¡å™¨åŠç”µå­é‚®ä»¶ï¼ˆIMAP/POP3ï¼‰ä»£ç†æœåŠ¡å™¨ã€‚ç”±ä¿„ç½—æ–¯çš„ç¨‹åºè®¾è®¡å¸ˆä¼Šæˆˆå°”Â·è¥¿ç´¢å¤«ï¼ˆIgor Sysoevï¼‰æ‰€å¼€å‘ï¼Œå®˜æ–¹æµ‹è¯• nginx èƒ½å¤Ÿæ”¯æ”¯æ’‘ 5 ä¸‡å¹¶å‘é“¾æ¥ï¼Œå¹¶ä¸” cpuã€å†…å­˜ç­‰èµ„æºæ¶ˆè€—å´éå¸¸ä½ï¼Œè¿è¡Œéå¸¸ç¨³å®šã€‚

ã€€ã€€â€‹![](assets/wps1-20221213094955-0xrrurr.jpg)â€‹

### 2.1.1 **Nginx åº”ç”¨åœºæ™¯ï¼š**

ã€€ã€€1ã€http æœåŠ¡å™¨ã€‚Nginx æ˜¯ä¸€ä¸ª http æœåŠ¡å¯ä»¥ç‹¬ç«‹æä¾› http æœåŠ¡ã€‚å¯ä»¥åšç½‘é¡µé™æ€æœåŠ¡å™¨ã€‚

ã€€ã€€2ã€è™šæ‹Ÿä¸»æœºã€‚å¯ä»¥å®ç°åœ¨ä¸€å°æœåŠ¡å™¨è™šæ‹Ÿå‡ºå¤šä¸ªç½‘ç«™ã€‚ä¾‹å¦‚ä¸ªäººç½‘ç«™ä½¿ç”¨çš„è™šæ‹Ÿä¸»æœºã€‚

ã€€ã€€3ã€åå‘ä»£ç†ï¼Œè´Ÿè½½å‡è¡¡ã€‚å½“ç½‘ç«™çš„è®¿é—®é‡è¾¾åˆ°ä¸€å®šç¨‹åº¦åï¼Œå•å°æœåŠ¡å™¨ä¸èƒ½æ»¡è¶³ç”¨æˆ·çš„è¯·æ±‚æ—¶ï¼Œéœ€è¦ç”¨å¤šå°æœåŠ¡å™¨é›†ç¾¤å¯ä»¥ä½¿ç”¨ nginx åšåå‘ä»£ç†ã€‚å¹¶ä¸”å¤šå°æœåŠ¡å™¨å¯ä»¥å¹³å‡åˆ†æ‹…è´Ÿè½½ï¼Œä¸ä¼šå› ä¸ºæŸå°æœåŠ¡å™¨è´Ÿè½½é«˜å®•æœºè€ŒæŸå°æœåŠ¡å™¨é—²ç½®çš„æƒ…å†µã€‚

![image](assets/image-20221215152215-rsevpn9.png)â€‹

## **2.2 Nginxåœ¨Linuxä¸‹çš„å®‰è£…**

ã€€ã€€é‡æ–°å‡†å¤‡ä¸€å°è™šæ‹Ÿæœºä½œä¸ºæœåŠ¡å™¨ã€‚æ¯”å¦‚IPåœ°å€ä¸º192.168.177.129

### **2.2.1ç¯å¢ƒå‡†å¤‡**

ã€€ã€€ï¼ˆ1ï¼‰éœ€è¦å®‰è£… gcc çš„ç¯å¢ƒ

ã€€ã€€â€‹`yum install gcc-c++ â€‹`â€‹

ã€€ã€€ï¼ˆ2ï¼‰ç¬¬ä¸‰æ–¹çš„å¼€å‘åŒ…ã€‚

ã€€ã€€  **PCRE**

ã€€ã€€   PCRE(Perl Compatible Regular Expressions)æ˜¯ä¸€ä¸ª Perl åº“ï¼ŒåŒ…æ‹¬ perl å…¼å®¹çš„æ­£åˆ™è¡¨è¾¾å¼åº“ã€‚nginx çš„ http æ¨¡å—ä½¿ç”¨ pcre æ¥è§£ææ­£åˆ™è¡¨è¾¾å¼ï¼Œæ‰€ä»¥éœ€è¦åœ¨ linux ä¸Šå®‰è£… pcre åº“ã€‚

ã€€ã€€â€‹`yum install -y pcre pcre-devel`â€‹

ã€€ã€€æ³¨ï¼špcre-devel æ˜¯ä½¿ç”¨ pcre å¼€å‘çš„ä¸€ä¸ªäºŒæ¬¡å¼€å‘åº“ã€‚nginx ä¹Ÿéœ€è¦æ­¤åº“ã€‚

ã€€ã€€   **zlib**

ã€€ã€€zlib åº“æä¾›äº†å¾ˆå¤šç§å‹ç¼©å’Œè§£å‹ç¼©çš„æ–¹å¼ï¼Œnginx ä½¿ç”¨ zlib å¯¹ http åŒ…çš„å†…å®¹è¿›è¡Œ gzipï¼Œæ‰€ä»¥éœ€è¦åœ¨ linux ä¸Šå®‰è£… zlib åº“ã€‚

ã€€ã€€â€‹`yum install -y zlib zlib-devel`â€‹

ã€€ã€€n  **OpenSSL**

ã€€ã€€OpenSSL æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®‰å…¨å¥—æ¥å­—å±‚å¯†ç åº“ï¼Œå›Šæ‹¬ä¸»è¦çš„å¯†ç ç®—æ³•ã€å¸¸ç”¨çš„å¯†é’¥å’Œè¯ä¹¦å°è£…ç®¡ç†åŠŸèƒ½åŠ SSL åè®®ï¼Œå¹¶æä¾›ä¸°å¯Œçš„åº”ç”¨ç¨‹åºä¾›æµ‹è¯•æˆ–å…¶å®ƒç›®çš„ä½¿ç”¨ã€‚nginx ä¸ä»…æ”¯æŒ http åè®®ï¼Œè¿˜æ”¯æŒ httpsï¼ˆå³åœ¨ ssl åè®®ä¸Šä¼ è¾“ httpï¼‰ï¼Œæ‰€ä»¥éœ€è¦åœ¨ linuxå®‰è£… openssl åº“ã€‚

ã€€ã€€â€‹`yum install -y openssl openssl-devel`â€‹

### **2.2.2 Nginxä¸‹è½½**

ã€€ã€€å®˜æ–¹ç½‘ç«™ä¸‹è½½ nginxï¼š[http://nginx.org/](http://nginx.org/)    [https://developer.aliyun.com/article/45729](https://developer.aliyun.com/article/45729)

ã€€ã€€æˆ‘ä»¬è¯¾ç¨‹ä¸­ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ 1.8.0 ç‰ˆæœ¬ã€‚

### **2.2.3 Nginxå®‰è£…**

ã€€ã€€ç¬¬ä¸€æ­¥ï¼šæŠŠ nginx çš„æºç åŒ…nginx-1.8.0.tar.gzä¸Šä¼ åˆ° linux ç³»ç»Ÿ

ã€€ã€€ç¬¬äºŒæ­¥ï¼šè§£å‹ç¼©

ã€€ã€€â€‹`tar zxvf nginx-1.8.0.tar.gz`â€‹

ã€€ã€€ç¬¬ä¸‰æ­¥ï¼šè¿›å…¥nginx-1.8.0ç›®å½•   ä½¿ç”¨ configure å‘½ä»¤åˆ›å»ºä¸€ makeFile æ–‡ä»¶ã€‚

```bash
./configure \
--prefix=/usr/local/nginx \
--pid-path=/var/run/nginx/nginx.pid \
--lock-path=/var/lock/nginx.lock \
--error-log-path=/var/log/nginx/error.log \
--http-log-path=/var/log/nginx/access.log \
--with-http_gzip_static_module \
--http-client-body-temp-path=/var/temp/nginx/client \
--http-proxy-temp-path=/var/temp/nginx/proxy \
--http-fastcgi-temp-path=/var/temp/nginx/fastcgi \
--http-uwsgi-temp-path=/var/temp/nginx/uwsgi \
--http-scgi-temp-path=/var/temp/nginx/scgi
```

ã€€ã€€æ‰§è¡Œåå¯ä»¥çœ‹åˆ°Makefileæ–‡ä»¶

ã€€ã€€â€‹![](assets/wps2-20221213094955-2ggpaam.jpg)

ã€€ã€€ç¬¬å››æ­¥ï¼šç¼–è¯‘

ã€€ã€€â€‹`make`â€‹â€‹

ã€€ã€€ç¬¬äº”æ­¥ï¼šå®‰è£…

ã€€ã€€â€‹`make install`â€‹â€‹

#### **çŸ¥è¯†ç‚¹å°è´´å£«**

> **configureå‚æ•°**
>
> **./configure **
>
> **--prefix=/usr \Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  æŒ‡å‘å®‰è£…ç›®å½•**
>
> **--sbin-path=/usr/sbin/nginx \Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  æŒ‡å‘ï¼ˆæ‰§è¡Œï¼‰ç¨‹åºæ–‡ä»¶ï¼ˆnginxï¼‰**
>
> **--conf-path=/etc/nginx/nginx.conf \Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â æŒ‡å‘é…ç½®æ–‡ä»¶**
>
> **--error-log-path=/var/log/nginx/error.log \Â Â Â Â Â Â Â Â Â Â Â Â Â  æŒ‡å‘log**
>
> **--http-log-path=/var/log/nginx/access.log \Â Â Â Â Â Â Â Â Â Â Â  æŒ‡å‘http-log**
>
> **--pid-path=/var/run/nginx/nginx.pid \Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  æŒ‡å‘pid**
>
> **--lock-path=/var/lock/nginx.lock \Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  ï¼ˆå®‰è£…æ–‡ä»¶é”å®šï¼Œé˜²æ­¢å®‰è£…æ–‡ä»¶è¢«åˆ«äººåˆ©ç”¨ï¼Œæˆ–è‡ªå·±è¯¯æ“ä½œã€‚ï¼‰**
>
> **--user=nginx **
>
> **--group=nginx **
>
> **--with-http_ssl_module \Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  å¯ç”¨ngx_http_ssl_moduleæ”¯æŒï¼ˆä½¿æ”¯æŒhttpsè¯·æ±‚ï¼Œéœ€å·²å®‰è£…opensslï¼‰**
>
> **--with-http_flv_module \Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  å¯ç”¨ngx_http_flv_moduleæ”¯æŒï¼ˆæä¾›å¯»æ±‚å†…å­˜ä½¿ç”¨åŸºäºæ—¶é—´çš„åç§»é‡æ–‡ä»¶ï¼‰**
>
> **--with-http_stub_status_module \Â Â Â Â  å¯ç”¨ngx_http_stub_status_moduleæ”¯æŒï¼ˆè·å–nginxè‡ªä¸Šæ¬¡å¯åŠ¨ä»¥æ¥çš„å·¥ä½œçŠ¶æ€ï¼‰**
>
> **--with-http_gzip_static_module \Â Â  å¯ç”¨ngx_http_gzip_static_moduleæ”¯æŒï¼ˆåœ¨çº¿å®æ—¶å‹ç¼©è¾“å‡ºæ•°æ®æµï¼‰**
>
> **--http-client-body-temp-path=/var/tmp/nginx/client/ \ è®¾å®šhttpå®¢æˆ·ç«¯è¯·æ±‚ä¸´æ—¶æ–‡ä»¶è·¯å¾„**
>
> **--http-proxy-temp-path=/var/tmp/nginx/proxy/ \ è®¾å®šhttpä»£ç†ä¸´æ—¶æ–‡ä»¶è·¯å¾„**
>
> **--http-fastcgi-temp-path=/var/tmp/nginx/fcgi/ \ è®¾å®šhttp fastcgiä¸´æ—¶æ–‡ä»¶è·¯å¾„**
>
> **--http-uwsgi-temp-path=/var/tmp/nginx/uwsgi \ è®¾å®šhttp uwsgiä¸´æ—¶æ–‡ä»¶è·¯å¾„**
>
> **--http-scgi-temp-path=/var/tmp/nginx/scgi \ è®¾å®šhttp scgiä¸´æ—¶æ–‡ä»¶è·¯å¾„**
>
> **--with-pcre å¯ç”¨pcreåº“**

## **2.3 Nginxå¯åŠ¨å…³é—­ä¸è®¿é—®**

ã€€ã€€æ³¨æ„ï¼šå¯åŠ¨nginx ä¹‹å‰ï¼Œä¸Šè¾¹å°†ä¸´æ—¶æ–‡ä»¶ç›®å½•æŒ‡å®šä¸º/var/temp/nginx/clientï¼Œ éœ€è¦åœ¨/var  ä¸‹åˆ›å»ºæ­¤ ç›®å½•

ã€€ã€€â€‹`mkdir /var/temp/nginx/client -p`â€‹

ã€€ã€€è¿›å…¥åˆ°Nginxç›®å½•ä¸‹çš„sbinç›®å½•

ã€€ã€€â€‹`cd /usr/local/ngiux/sbin`â€‹

ã€€ã€€è¾“å…¥å‘½ä»¤å¯åŠ¨Nginx

ã€€ã€€â€‹`./nginx`â€‹

ã€€ã€€å¯åŠ¨åæŸ¥çœ‹è¿›ç¨‹

ã€€ã€€â€‹`ps aux | grep nginx`â€‹â€‹

ã€€ã€€â€‹![](assets/wps3-20221213094955-a2qfqgy.jpg)â€‹

ã€€ã€€åœ°å€æ è¾“å…¥è™šæ‹Ÿæœºçš„IPå³å¯è®¿é—®ï¼ˆé»˜è®¤ä¸º80ç«¯å£ï¼‰

ã€€ã€€å…³é—­ nginxï¼š

ã€€ã€€â€‹`./nginx -s stop`â€‹

ã€€ã€€æˆ–è€…

ã€€ã€€â€‹`./nginx -s quit`â€‹

ã€€ã€€é‡å¯ nginxï¼š

ã€€ã€€1ã€å…ˆå…³é—­åå¯åŠ¨ã€‚

ã€€ã€€2ã€åˆ·æ–°é…ç½®æ–‡ä»¶ï¼š

ã€€ã€€â€‹`./nginx -s reload`â€‹

# **3.Nginxé™æ€ç½‘ç«™éƒ¨ç½²**

## **3.1 é™æ€ç½‘ç«™çš„éƒ¨ç½²**

ã€€ã€€å°†/èµ„æ–™/é™æ€é¡µé¢/indexç›®å½•ä¸‹çš„æ‰€æœ‰å†…å®¹ ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„/usr/local/nginx/htmlä¸‹å³å¯è®¿é—®

ã€€ã€€â€‹![image](assets/image-20221213171513-l1oxcun.png)â€‹

## **3.2 é…ç½®è™šæ‹Ÿä¸»æœº**

ã€€ã€€è™šæ‹Ÿä¸»æœºï¼Œä¹Ÿå«â€œç½‘ç«™ç©ºé—´â€ï¼Œå°±æ˜¯æŠŠä¸€å°è¿è¡Œåœ¨äº’è”ç½‘ä¸Šçš„ç‰©ç†æœåŠ¡å™¨åˆ’åˆ†æˆå¤šä¸ªâ€œè™šæ‹Ÿâ€æœåŠ¡å™¨ã€‚è™šæ‹Ÿä¸»æœºæŠ€æœ¯æå¤§çš„ä¿ƒè¿›äº†ç½‘ç»œæŠ€æœ¯çš„åº”ç”¨å’Œæ™®åŠã€‚åŒæ—¶è™šæ‹Ÿä¸»æœºçš„ç§Ÿç”¨æœåŠ¡ä¹Ÿæˆäº†ç½‘ç»œæ—¶ä»£çš„ä¸€ç§æ–°å‹ç»æµå½¢å¼ã€‚

### **3.2.1 ç«¯å£ç»‘å®š**

ã€€ã€€ï¼ˆ1ï¼‰ä¸Šä¼ é™æ€ç½‘ç«™ï¼š

ã€€ã€€å°†/èµ„æ–™/é™æ€é¡µé¢/indexç›®å½•ä¸Šä¼ è‡³  /usr/local/nginx/indexä¸‹

ã€€ã€€å°†/èµ„æ–™/é™æ€é¡µé¢/registç›®å½•ä¸Šä¼ è‡³  /usr/local/nginx/registä¸‹

ã€€ã€€ï¼ˆ2ï¼‰ä¿®æ”¹Nginx çš„é…ç½®æ–‡ä»¶ï¼š/usr/local/nginx/conf/nginx.conf

â€

> ğŸ‘³å°æŠ€å·§
>
> sed -i '/#/d' nginx.conf        #åˆ é™¤é…ç½®æ³¨é‡Š
>
> sed -i '/^$/d' nginx.conf       #åˆ é™¤ç©ºè¡Œ

```nginx
 server {
        listen       81; # ç›‘å¬çš„ç«¯å£
        server_name  localhost; # åŸŸåæˆ–ip
        location / {	# è®¿é—®è·¯å¾„é…ç½®
                root   html;# æ ¹ç›®å½•
                index  index.html index.htm; # é»˜è®¤é¦–é¡µ
                }
       error_page   500 502 503 504  /50x.html;
                location = /50x.html {
                         root   html;
               }

       }
 server {
        listen       82; 
        server_name  localhost; 
        location / {
              root   html;
              index  regist.html; 
        }
        error_page   500 502 503 504 /50x.html;
        location = /50x.html {
              root   html;
        }
    }


```

ã€€ã€€ï¼ˆ3ï¼‰è®¿é—®æµ‹è¯•ï¼š

ã€€ã€€åœ°å€æ è¾“å…¥[http://192.168.133.130:81](http://192.168.133.130:81) å¯ä»¥çœ‹åˆ°é¦–é¡µé¢

ã€€ã€€åœ°å€æ è¾“å…¥[http://192.168.133.130:82](http://192.168.133.130:82) å¯ä»¥çœ‹åˆ°æ³¨å†Œé¡µé¢

### **3.2.2 åŸŸåç»‘å®š**

ã€€ã€€åŸŸå

ã€€ã€€**åŸŸåä¸IPç»‘å®šï¼š**

ã€€ã€€ä¸€ä¸ªåŸŸåå¯¹åº”ä¸€ä¸ª ip åœ°å€ï¼Œä¸€ä¸ª ip åœ°å€å¯ä»¥è¢«å¤šä¸ªåŸŸåç»‘å®šã€‚

ã€€ã€€å¯ä»¥é…ç½®åŸŸåå’Œ ip çš„æ˜ å°„å…³ç³»ï¼Œå¦‚æœ <u>**hosts æ–‡ä»¶**</u>ä¸­é…ç½®äº†åŸŸåå’Œ ip çš„å¯¹åº”å…³ç³»ï¼Œä¸éœ€è¦èµ°dns æœåŠ¡å™¨ã€‚

ã€€ã€€æœ¬åœ°æµ‹è¯•å¯ä»¥ä¿®æ”¹ hosts æ–‡ä»¶ï¼ˆC:\Windows\System32\drivers\etcï¼‰

ã€€ã€€192.168.133.130	[www.travel.com](http://www.travel.com)

ã€€ã€€192.168.133.130	regist.travel.com

ã€€ã€€åšå¥½åŸŸåæŒ‡å‘åï¼Œä¿®æ”¹nginxé…ç½®æ–‡ä»¶

```nginx
 server {                                                               
        listen       80;
        server_name  www.travel.com;
        location / {
            root   html;
            index  index.html;
  }
}
server {
        listen       80;
        server_name  regist.travel.com;
        location / {
            root   html;
            index  regist.html;
        }
    }
```

ã€€ã€€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œåˆ·æ–°é…ç½®

ã€€ã€€[root@localhost sbin]# ./nginx -s reload

ã€€ã€€æµ‹è¯•ï¼š

ã€€ã€€åœ°å€æ è¾“å…¥[http://www.travel.com/](http://www.travel.com/)

ã€€ã€€â€‹![image](assets/image-20221213173037-3d1u0tk.png)â€‹

ã€€ã€€åœ°å€æ è¾“å…¥[http://regist.travel.com/](http://regist.travel.com/)

ã€€ã€€â€‹![image](assets/image-20221213173102-b2f2891.png)â€‹

# **4.Nginxåå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡**

## **4.1 åå‘ä»£ç†**

### **4.1.1 ä»€ä¹ˆæ˜¯åå‘ä»£ç†**

ã€€ã€€åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ–¹å¼æ˜¯æŒ‡ä»¥[ä»£ç†æœåŠ¡å™¨](http://baike.baidu.com/item/%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8)æ¥æ¥å—internetä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™internetä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚

ã€€ã€€é¦–å…ˆæˆ‘ä»¬å…ˆç†è§£æ­£å‘ä»£ç†ï¼Œå¦‚ä¸‹å›¾ï¼š

ã€€ã€€â€‹![](assets/wps7-20221213094955-n9ab12n.jpg)â€‹

ã€€ã€€æ­£å‘ä»£ç†æ˜¯é’ˆå¯¹ä½ çš„å®¢æˆ·ç«¯ï¼Œè€Œåå‘ä»£ç†æ˜¯é’ˆå¯¹æœåŠ¡å™¨çš„ï¼Œå¦‚ä¸‹å›¾

ã€€ã€€â€‹![](assets/wps8-20221213094955-sfzcz41.jpg)â€‹

ã€€ã€€â€‹![](assets/wps9-20221213094955-57gdcvj.jpg)â€‹

### **4.1.2 é…ç½®åå‘ä»£ç†-å‡†å¤‡å·¥ä½œ**

ã€€ã€€ï¼ˆ1ï¼‰ å°†travelæ¡ˆä¾‹éƒ¨ç½²åˆ°tomcatä¸­ï¼ˆROOTç›®å½•ï¼‰ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚

ã€€ã€€ï¼ˆ2ï¼‰å¯åŠ¨TOMCATï¼Œè¾“å…¥ç½‘å€[http://192.168.133.130:8080](http://192.168.133.130:8080) å¯ä»¥çœ‹åˆ°ç½‘ç«™é¦–é¡µ

### **4.1.3 é…ç½®åå‘ä»£ç†**

ã€€ã€€ï¼ˆ1ï¼‰åœ¨Nginxä¸»æœºä¿®æ”¹ Nginxé…ç½®æ–‡ä»¶

```nginx
upstream tomcat-travel{
ï¼ˆ1ï¼‰åœ¨Nginxä¸»æœºä¿®æ”¹ Nginxé…ç½®æ–‡ä»¶
   upstream tomcat-travel{
	      server 192.168.133.130:8080;  
  }
    server {
        listen       80; # ç›‘å¬çš„ç«¯å£
        server_name  www.travel.com; # åŸŸåæˆ–ip
        location / {	# è®¿é—®è·¯å¾„é…ç½®
            # root   index;# æ ¹ç›®å½•
	    proxy_pass http://tomcat-travel;
            index  index.html index.htm; # é»˜è®¤é¦–é¡µ
        }
}
```

ã€€ã€€ï¼ˆ2ï¼‰é‡æ–°å¯åŠ¨Nginx  ç„¶åç”¨æµè§ˆå™¨æµ‹è¯•ï¼š[http://www.travel.com](http://www.hmtravel.com)  ï¼ˆæ­¤åŸŸåé¡»é…ç½®åŸŸåæŒ‡å‘ï¼‰

## **4.2 è´Ÿè½½å‡è¡¡**

### **4.2.1 ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡**

ã€€ã€€è´Ÿè½½å‡è¡¡ å»ºç«‹åœ¨ç°æœ‰ç½‘ç»œç»“æ„ä¹‹ä¸Šï¼Œå®ƒæä¾›äº†ä¸€ç§å»‰ä»·æœ‰æ•ˆé€æ˜çš„æ–¹æ³•æ‰©å±•[ç½‘ç»œè®¾å¤‡](http://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87)å’Œ[æœåŠ¡å™¨](http://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E5%99%A8)çš„å¸¦å®½ã€å¢åŠ [ååé‡](http://baike.baidu.com/item/%E5%90%9E%E5%90%90%E9%87%8F)ã€åŠ å¼ºç½‘ç»œæ•°æ®å¤„ç†èƒ½åŠ›ã€æé«˜ç½‘ç»œçš„çµæ´»æ€§å’Œå¯ç”¨æ€§ã€‚

ã€€ã€€è´Ÿè½½å‡è¡¡ï¼Œè‹±æ–‡åç§°ä¸ºLoad Balanceï¼Œå…¶æ„æ€å°±æ˜¯åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿›è¡Œæ‰§è¡Œï¼Œä¾‹å¦‚Web[æœåŠ¡å™¨](http://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E5%99%A8)ã€[FTPæœåŠ¡å™¨](http://baike.baidu.com/item/FTP%E6%9C%8D%E5%8A%A1%E5%99%A8)ã€[ä¼ä¸š](http://baike.baidu.com/item/%E4%BC%81%E4%B8%9A)å…³é”®åº”ç”¨æœåŠ¡å™¨å’Œå…¶å®ƒå…³é”®ä»»åŠ¡æœåŠ¡å™¨ç­‰ï¼Œä»è€Œå…±åŒå®Œæˆå·¥ä½œä»»åŠ¡ã€‚

### **4.2.2 é…ç½®è´Ÿè½½å‡è¡¡-å‡†å¤‡å·¥ä½œ**

ã€€ã€€ï¼ˆ1ï¼‰å°†åˆšæ‰çš„å­˜æ”¾å·¥ç¨‹çš„tomcatå¤åˆ¶ä¸‰ä»½ï¼Œä¿®æ”¹ç«¯å£åˆ†åˆ«ä¸º8080 ï¼Œ8081ï¼Œ8082 ã€‚

ã€€ã€€ï¼ˆ2ï¼‰åˆ†åˆ«å¯åŠ¨è¿™ä¸‰ä¸ªtomcatæœåŠ¡ã€‚

ã€€ã€€ï¼ˆ3ï¼‰ä¸ºäº†èƒ½å¤ŸåŒºåˆ†æ˜¯è®¿é—®å“ªä¸ªæœåŠ¡å™¨çš„ç½‘ç«™ï¼Œå¯ä»¥åœ¨é¦–é¡µæ ‡é¢˜åŠ ä¸Šæ ‡è®°ä»¥ä¾¿åŒºåˆ†ã€‚

### **4.2.3 é…ç½®è´Ÿè½½å‡è¡¡**

ã€€ã€€ä¿®æ”¹ Nginxé…ç½®æ–‡ä»¶ï¼š

```nginx
 upstream tomcat-travel {
	   server 192.168.133.130:8080;
	   server 192.168.133.130:8081;
	   server 192.168.133.130:8082;
    }
    server {
        listen       80; # ç›‘å¬çš„ç«¯å£
        server_name  www.travel.com; # åŸŸåæˆ–ip
        location / {	# è®¿é—®è·¯å¾„é…ç½®
            # root   index;# æ ¹ç›®å½•
	    proxy_pass http://tomcat-travel;

            index  index.html index.htm; # é»˜è®¤é¦–é¡µ
        }
        error_page   500 502 503 504  /50x.html;	# é”™è¯¯é¡µé¢
        location = /50x.html {
            root   html;
        }
   }
```

ã€€ã€€åœ°å€æ è¾“å…¥[http://www.travel.com/ ](http://www.travel.com/) åˆ·æ–°è§‚å¯Ÿæ¯ä¸ªç½‘é¡µçš„æ ‡é¢˜ï¼Œçœ‹æ˜¯å¦ä¸åŒã€‚

ã€€ã€€ç»è¿‡æµ‹è¯•ï¼Œä¸‰å°æœåŠ¡å™¨å‡ºç°çš„æ¦‚ç‡å„ä¸º33.3333333%ï¼Œäº¤æ›¿æ˜¾ç¤ºã€‚

ã€€ã€€å¦‚æœå…¶ä¸­ä¸€å°æœåŠ¡å™¨æ€§èƒ½æ¯”è¾ƒå¥½ï¼Œæƒ³è®©å…¶æ‰¿æ‹…æ›´å¤šçš„å‹åŠ›ï¼Œå¯ä»¥è®¾ç½®æƒé‡ã€‚

ã€€ã€€æ¯”å¦‚æƒ³è®©NO.1å‡ºç°æ¬¡æ•°æ˜¯å…¶å®ƒæœåŠ¡å™¨çš„2å€ï¼Œåˆ™ä¿®æ”¹é…ç½®å¦‚ä¸‹ï¼š

```nginx
upstream tomcat-travel {
	   server 192.168.133.130:8080;
	   server 192.168.133.130:8081 weight=2;
	   server 192.168.133.130:8082;
    }
```

ã€€ã€€ç»è¿‡æµ‹è¯•ï¼Œæ¯åˆ·æ–°å››æ¬¡ï¼Œæœ‰ä¸¤æ¬¡æ˜¯8081

ã€€ã€€â€

ã€€ã€€â€

ã€€ã€€â€

ã€€ã€€â€

ã€€ã€€â€
