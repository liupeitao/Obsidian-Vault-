# selenium

```
from selenium import webdriver
from selenium.webdriver.common.by import By 
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.action_chains import ActionChains

driver =  webdriver.Chrome()
driver.get('https://www.baidu.com')
```

## [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E4%BB%A3%E7%A0%81-cookie-%E7%AD%89)获取页面代码, cookie 等

```
driver.page_source
```

```
driver.get_cookies()
```

## [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0)选择元素

1.  `By.id()`：通过元素的id属性来定位元素，$：`driver.find_element(By.id('my-id'))`。
2.  `By.name()`：通过元素的name属性来定位元素，$：`driver.find_element(By.name('my-name'))`。
3.  `By.xpath()`：通过元素的XPath路径来定位元素，$：`driver.find_element(By.xpath('//div[@class="my-class"]'))`。
4.  `By.cssSelector()`：通过元素的CSS选择器来定位元素，$：`driver.find_element(By.cssSelector('.my-class'))`。
5.  `By.className()`：通过元素的class属性来定位元素，$：`driver.find_element(By.className('my-class'))`。
6.  `By.tagName()`：通过元素的标签名来定位元素，$：`driver.find_element(By.tagName('div'))`。

### [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#xpah)XPAH

```
element = driver.find_element(by=By.XPATH, value='/html/body')
print(element)
```

```
element = driver.find_element(by=By.XPATH, value='//*[@id="s_tab"]')
print(element)
```

div

## [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#%E8%8E%B7%E5%8F%96%E8%8A%82%E7%82%B9%E5%86%85%E5%AE%B9)获取节点内容

有了其中一个定位节点的方法如xpath, 就可以获取到节点相关信息了

```
# 获取元素的文本内容：
text = element.text
```

```
# 获取元素的属性值：
value = element.get_attribute("class")
```

### [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#id-name-tag_name-class_name)ID NAME TAG_NAME CLASS_NAME

```
element = driver.find_element(by=By.ID, value='kw')
element.send_keys('图灵')
element1 = driver.find_element(value='kw')
print(element == element1)   # output True , prove it use by.ID default
```

True

```
element = driver.find_element(by=By.NAME, value='wd')
str = '牛顿'
element.send_keys(str)
print(element)
```

```
element = driver.find_element(by=By.TAG_NAME, value='div')
print(element)
```

```
element = driver.find_element(by=By.CLASS_NAME, value='cos-pc')
print(element)
```

### [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#css-selector)CSS SELECTOR

1.  标签选择器：使用HTML标签名作为选择器，$：`div { color: red; }`。
2.  类选择器：使用类名作为选择器，以 `.` 开头, $：`.my-class { font-size: 16px; }`。
3.  ID选择器：使用元素的ID作为选择器，以 `#` 开头 $：`#my-id { background-color: yellow; }`。
4.  属性选择器：根据元素的属性来选择元素，$：`a[href] { text-decoration: none; }`。
5.  子元素选择器：使用 `>` 符号来选择某个元素的直接子元素，$：`.menu > li { display: inline-block; }`。
6.  后代元素选择器：使用空格来选择某个元素下的所有后代元素，例如 `ul li` 可以选择所有 `<ul>` 元素下的所有 `<li>` 元素，例如：`.container p { line-height: 1.5; }`。
7.  相邻兄弟选择器：使用 `+` 符号来选择某个元素后面相邻的兄弟元素，例如 `h1 + p` 可以选择紧接着 `<h1>` 元素后面的 `<p>` 元素，例如：`.title + p { margin-top: 10px; }`。
8.  通用选择器：使用 `*` 符号来选择所有元素，例如 `*` 可以选择页面中的所有元素，例如：`* { box-sizing: border-box; }`

> > `* { box-sizing: border-box; }` 后面的{ } 里面的内容标识css 属性

```
element = driver.find_element(by=By.CSS_SELECTOR, value="input[name='wd']")
element.send_keys("图灵")
print(element.get_attribute('name'))
print(element.get_attribute('id'))
element.send_keys(Keys.ENTER)
```

wd
kw

```
element = driver.find_element(by=By.CSS_SELECTOR, value='head>meta[name="theme-color"]')
print(element)
```

```
element = driver.find_element(by=By.CSS_SELECTOR, value='meta+title')
print(element)
```

```
elements = driver.find_elements(by=By.CSS_SELECTOR, value='li')
for element in elements:
    print(element)
```

## [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#%E6%A8%A1%E6%8B%9F%E9%BC%A0%E6%A0%87)模拟鼠标

### [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#%E6%A8%A1%E6%8B%9F%E7%82%B9%E5%87%BB%E5%92%8C%E7%A7%BB%E5%8A%A8)模拟点击和移动

```
# 移动到某个元素然后点击。 这里的click()是一种多态行为
ActionChains(driver).move_to_element(element).click().perform()
```

```
# 模拟鼠标右键
ActionChains(driver).move_to_element(element).context_click().perform()
```

### [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#%E6%A8%A1%E6%8B%9F%E6%BB%9A%E8%BD%AE)模拟滚轮

一般是执行js

```
# 浏览器页面向下滑动到5000位置：
driver.execute_script("window.scrollTo(0,5000)")
```

```
# 向下滑动1000个像素
driver.execute_script("window.scrollBy(0,1000)")
```

```
# 你可以用键盘翻页键
ActionChains(driver).send_keys(Keys.PAGE_DOWN).perform()
```

## [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#%E6%88%AA%E5%9B%BE%E6%93%8D%E4%BD%9C)截图操作

默认保存在当前路径

```
driver.save_screenshot("screenshot.png")
```

## [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#%E5%85%B6%E4%BB%96)其他

1.  执行 JavaScript：`$ driver.execute_script("javascript_code")`
2.  屏幕截图（Screenshot）: $ `driver.save_screenshot("screenshot.png")`
3.  关闭浏览器（Close Browser）：$ `driver.quit()`
4.  等待（Waiting）：

-   隐式等待：$ `driver.implicitly_wait(10)`
-   显式等待：$ `WebDriverWait(driver, 10).until(EC.visibility_of_element_located((By.ID, "element_id")))`

## [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#excise)excise

## [](https://gitee.com/liupeitao/csapi/blob/master/selenium.ipynb#%E6%89%93%E5%AD%97%E7%BB%83%E4%B9%A0-httpsdazikukuwcom)打字练习 [https://dazi.kukuw.com/](https://gitee.com/link?target=https%3A%2F%2Fdazi.kukuw.com%2F)

```
from selenium import webdriver
from selenium.webdriver.common.by import By 
from selenium.webdriver.common.keys import Keys

driver =  webdriver.Chrome()
driver.get('https://dazi.kukuw.com/')
```

```
element = driver.find_element(by=By.CSS_SELECTOR, value='input[name="start_button"]')
element.click()
```

```
text_lines = driver.find_elements(by=By.CSS_SELECTOR, value='div[class="text"]>span')
for line in text_lines:
    print(line.text)
```

```
elements = driver.find_elements(by=By.CSS_SELECTOR, value='input[autocomplete="off"]')
import time

for index, element in enumerate(elements):
    # element.send_keys(text_lines[index].text)
    for char in text_lines[index].text:
        element.send_keys(char)
        time.sleep(0.001)
    element.send_keys(Keys.SPACE)
```